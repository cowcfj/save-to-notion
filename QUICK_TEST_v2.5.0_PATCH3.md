# 🚀 v2.5.0 快速測試（PATCH3 修復後）

## ✅ 關鍵修復
**已修復：** 開啟標註模式後無法選擇文字的問題  
**原因：** 移除了 `selection.removeAllRanges()`  
**效果：** 標註和選擇可以共存，符合 CSS Highlight API 設計理念

---

## 🧪 3 步驟快速驗證

### 1️⃣ **測試正常選擇（未開啟標註模式）**
```
操作：
1. 打開任意網頁
2. 直接選擇文字（不點擊擴展）
3. 嘗試複製（Ctrl+C）

預期：
✅ 選擇正常
✅ 複製成功
✅ 沒有黃色標註出現
```

### 2️⃣ **測試標註模式選擇（核心測試）**
```
操作：
1. 點擊擴展圖標 → 點擊 "📝 Start Highlighting"
2. 彈出窗口關閉後，頁面左上角出現工具欄
3. 選擇一段文字（20-50字）
4. 鬆開鼠標

預期：
✅ 文字變成黃色背景
✅ 選擇仍然可見（藍色+黃色疊加）
✅ 可以立即按 Ctrl+C 複製
✅ 控制台顯示：
   📍 選擇了文本: "..."
   ✅ 標註已創建: highlight-1，黃色標記已應用
```

### 3️⃣ **測試跨元素標註（原始問題）**
```
操作：
1. 標註模式下
2. 從一個段落選擇到另一個段落
3. 鬆開鼠標

預期：
✅ 兩個段落都變黃
✅ 選擇保持可見
✅ 沒有錯誤
✅ 可以複製跨段落的文字
```

---

## 🎯 關鍵行為變化

### ❌ PATCH2（有問題）
```
選擇文字 → 標註 → 選擇立即消失 → 無法複製
```

### ✅ PATCH3（修復後）
```
選擇文字 → 標註 → 選擇保留 → 可以複製 → 點擊其他地方時自然消失
```

---

## 🔍 控制台快速診斷

打開控制台（F12），運行：

```javascript
// 快速檢查
console.log('=== 快速診斷 ===');
console.log('API 支持:', typeof CSS !== 'undefined' && 'highlights' in CSS);
console.log('工具已加載:', typeof window.initHighlighter);
console.log('工具已初始化:', typeof window.notionHighlighter);

// 如果都是 true，系統正常
```

---

## ✨ 新特性體驗

### 標註 + 選擇共存
```
視覺效果：
┌────────────────────────────┐
│ 普通文字                   │
│ █████████ 選擇的文字       │  ← 藍色選擇高亮
│ ▓▓▓▓▓▓▓▓▓ 標註的文字       │  ← 黃色標註背景
│ ▓█████████ 剛標註的文字    │  ← 藍+黃疊加
└────────────────────────────┘
```

### 操作流程優化
```
舊版：選擇 → 標註 → 選擇消失 → 想複製要重新選
新版：選擇 → 標註 → 選擇保留 → 立即可複製 ✨
```

---

## 🐛 如遇問題

### 問題 1：標註模式下還是無法選擇文字
**檢查：** 
```javascript
// 控制台運行
const sel = window.getSelection();
console.log('選擇狀態:', sel.toString());
```
**可能原因：** 
- 擴展未完全重新加載
- 其他擴展干擾

**解決：** 
1. `chrome://extensions/` → 移除擴展
2. 重新加載擴展
3. 刷新測試頁面

### 問題 2：標註不顯示
**檢查：**
```javascript
console.log('標註數量:', CSS.highlights.size);
```
**解決：** 參考 `TESTING_GUIDE_v2.5.0.md` 詳細排查

---

## 📊 成功標準

- [ ] 未開啟模式：正常選擇文字
- [ ] 開啟模式：可以選擇文字
- [ ] 標註後：選擇保留，文字變黃
- [ ] 標註後：可以立即複製
- [ ] 跨元素：選擇和標註都成功
- [ ] 控制台：無錯誤，有成功日誌

**如果以上全部通過 → 修復成功！** ✅

---

**最後更新：** 2025年10月1日  
**版本：** v2.5.0-patch3  
**修復問題：** 標註模式下無法選擇文字
