# 📖 Notion Smart Clipper 完整使用指南

> **版本**: v2.8.0+ | **更新日期**: 2025-10-07

本指南涵蓋擴展的所有功能、使用技巧和常見問題解決方案。

---

## 📑 目錄

- [🚀 快速開始](#-快速開始)
- [📖 基礎操作](#-基礎操作)
- [🎨 高級功能](#-高級功能)
- [💡 使用技巧](#-使用技巧)
- [❓ 常見問題 FAQ](#-常見問題-faq)
- [🔧 故障排除](#-故障排除)
- [📝 最佳實踐](#-最佳實踐)

---

## 🚀 快速開始

### 第一步：安裝擴展

#### 方法一：從 Chrome 線上應用程式商店安裝（推薦）

1. 訪問 [Chrome Web Store - Save to Notion Smart Clipper](https://chromewebstore.google.com/detail/save-to-notion-smart-clip/gmelegphcncnddlaeogfhododhbcbmhp) 🔗
2. 點擊「**加到 Chrome**」按鈕
3. 在彈出的對話框中點擊「**新增擴充功能**」
4. ✅ 安裝完成!瀏覽器工具欄會顯示 Notion 圖標

#### 方法二：從源碼安裝（開發者模式）

適合想要使用最新功能或進行自定義的使用者:

1. **下載源碼**
   - 從 [GitHub Releases](https://github.com/cowcfj/save-to-notion/releases) 下載最新版本
   - 或克隆倉庫: `git clone https://github.com/cowcfj/save-to-notion.git`

2. **載入擴展**
   - 打開 Chrome 瀏覽器，訪問 `chrome://extensions/`
   - 開啟右上角的「**開發者模式**」
   - 點擊「**載入未封裝項目**」
   - 選擇下載/克隆的專案資料夾

3. ✅ 安裝成功後，瀏覽器工具欄會顯示 Notion 圖標

### 第二步：連接 Notion

1. **創建 Notion Integration**
   - 訪問 [Notion Integrations](https://www.notion.so/my-integrations)
   - 點擊「+ New integration」
   - 填寫名稱(如 "Chrome Clipper")，選擇工作區
   - 複製生成的 **Internal Integration Token**

2. **配置擴展**
   - 點擊擴展圖標 → 點擊 `⚙️ Settings`
   - 貼上 API Token
   - 點擊「**連接到 Notion**」
   - 從下拉列表選擇目標數據庫
   - 點擊「**保存設置**」

3. **授權數據庫訪問**
   - 在 Notion 中打開目標數據庫
   - 點擊右上角「`...`」→「**Add connections**」
   - 選擇你剛創建的 Integration

🎉 配置完成！現在可以開始保存網頁了。

---

## 📖 基礎操作

### 1️⃣ 保存網頁

**操作步驟：**
1. 瀏覽到想要保存的網頁
2. 點擊擴展圖標
3. 點擊「**💾 Save Page**」按鈕
4. 等待保存完成（通常 2-5 秒）

**保存成功的標誌：**
- ✅ 擴展圖標右上角顯示**綠色 "✓" 徽章**
- ✅ 彈出窗口顯示「**🔗 Open in Notion**」按鈕
- ✅ 頁面內容和標註已同步到 Notion

**自動提取的內容：**
- 📝 文章標題
- 📄 主要內容（使用 Mozilla Readability 智能提取）
- 🖼️ 封面圖片（如果有）
- 🌐 網站圖標
- 📅 保存時間
- 🔗 原始 URL

### 2️⃣ 查看保存狀態

**圖標徽章系統：**
- **有綠色 "✓"** = 頁面已保存到 Notion
- **無徽章** = 頁面未保存

**徽章自動更新：**
- 切換到已保存的頁面時自動顯示
- 保存成功後立即顯示
- 在 Notion 中刪除頁面後自動清除

### 3️⃣ 快速打開 Notion 頁面

**雙重入口設計：**

**方法一：彈出窗口按鈕**
1. 點擊擴展圖標
2. 等待 1-2 秒（按鈕異步加載）
3. 點擊「**🔗 Open in Notion**」
4. 頁面在新標籤中打開

**方法二：標註工具欄按鈕（v2.8.0 新增）**
1. 開啟標註模式
2. 在標註工具欄中點擊「**🔗 打開**」按鈕
3. 或在標註列表頭部點擊「**🔗 打開**」按鈕
4. 頁面在新標籤中打開

**注意事項：**
- 僅在頁面已保存時顯示
- 標註後按鈕不會消失（v2.8.0 修復）
- 同步成功後按鈕狀態自動更新
- 完美支持舊版本保存的數據

### 4️⃣ 文本標註

**啟用標註模式：**
1. 點擊擴展圖標
2. 點擊「**🎨 Start Highlighting**」
3. 選擇標註顏色：
   - 🟡 **黃色** - 常規標記
   - 🟢 **綠色** - 重要內容
   - 🔵 **藍色** - 參考信息
   - 🔴 **紅色** - 關鍵要點
   - 🟣 **紫色** - 補充說明

**創建標註：**
1. 在頁面上選中文字（支持跨段落選擇）
2. 標註自動創建
3. 點擊「**同步**」按鈕將標註保存到 Notion

**刪除標註：**
- **方法 1**：雙擊標註文本 → 確認刪除
- **方法 2**：按住 `Ctrl`（Windows）或 `Cmd`（Mac）+ 點擊標註

**標註特性：**
- ✅ **零 DOM 修改**：使用 CSS Highlight API，不破壞頁面結構
- ✅ **跨元素支持**：可以跨段落、跨區塊選擇
- ✅ **實時同步**：標註變更即時保存到 Notion
- ✅ **自動遷移**：舊版標註自動升級到新系統

---

## 🎨 高級功能

### 🎯 自定義標題模板

**模板變量：**
- `{title}` - 網頁標題
- `{date}` - 保存日期（格式：YYYY-MM-DD）
- `{domain}` - 網站域名（如 example.com）
- `{url}` - 完整 URL

**配置步驟：**
1. 點擊擴展圖標 → `⚙️ Settings`
2. 在「**標題模板**」欄位輸入模板
3. 點擊「**預覽效果**」查看結果
4. 點擊「**保存設置**」

**示例模板：**
```
[{domain}] {title}
→ 結果：[example.com] 文章標題

{date} - {title}
→ 結果：2025-10-05 - 文章標題

📌 {title} | {domain}
→ 結果：📌 文章標題 | example.com
```

### 🖼️ 智能圖片處理

**自動提取網站圖標：**
- 優先選擇 Apple Touch Icon（高質量）
- 回退到 favicon、og:image 等
- 自動過濾無效圖標

**封面圖識別：**
- 支持 20+ 種選擇器（`og:image`、`article:image` 等）
- 自動處理懶加載圖片（`data-src`、`data-lazy` 等）
- 智能過濾作者頭像和廣告圖片
- 自動清理代理和 CDN 參數

**圖片處理特性：**
- ✅ 響應式圖片支持（自動選擇最高分辨率）
- ✅ 代理 URL 處理（清理 `?w=`、`?resize=` 等參數）
- ✅ 作者頭像過濾（避免錯誤作為封面）

### 📄 內容自定義選項

**在設置中可配置：**
- ☑️ **添加保存時間戳**（顯示在內容頂部）
- ☑️ **添加來源信息**（包含原始 URL 和域名）
- ☑️ **使用自定義模板**（標題格式化）

### 🚀 超長文章支持（v2.7.3+）

**自動分批處理：**
- 支持保存任意長度的文章
- 自動分批上傳（每批最多 100 個區塊）
- 遵守 Notion API 限制（3 請求/秒）
- 批次間延遲 350ms

**用戶體驗：**
- 無需手動操作
- 顯示批次進度（如 "📤 [發送批次 1/3]"）
- 部分失敗時繼續處理後續批次

---

## 💡 使用技巧

### 💪 工作流優化

**技巧 1：批量檢查保存狀態**
```
1. 打開多個標籤頁
2. 快速切換並查看圖標徽章
3. 識別哪些頁面已保存 ✓
4. 避免重複保存
```

**技巧 2：保存後立即整理**
```
1. 保存頁面
2. 點擊 "Open in Notion"
3. 立即添加標籤、評論、分類
4. 工作流一氣呵成 🚀
```

**技巧 3：多色標註分類**
```
🟡 黃色 = 常規標記
🟢 綠色 = 重要內容
🔵 藍色 = 參考資料
🔴 紅色 = 核心要點
🟣 紫色 = 個人思考
```

### 🎯 效率提升

**快速保存：**
- 使用鍵盤快捷鍵（可在 Chrome 設置中配置）
- 先標註，後保存（一次同步所有標註）

**批量處理：**
- 多個標籤頁中分別標註
- 最後統一保存（節省時間）

**模板復用：**
- 為不同類型內容設置不同模板
- 保存設置可隨時切換

---

## ❓ 常見問題 FAQ

### 🔌 連接和配置問題

**Q1: 無法連接到 Notion？**

**A:** 檢查以下項目：
1. ✅ API Token 是否正確複製（無多餘空格）
2. ✅ Integration 是否已創建並激活
3. ✅ 網絡連接是否正常
4. ✅ 在設置頁點擊「測試連接」診斷問題

**解決步驟：**
```
1. 重新生成 API Token
2. 清除設置並重新輸入
3. 檢查瀏覽器控制台錯誤（F12）
```

**Q2: 看不到我的數據庫？**

**A:** 確保：
1. Integration 已添加到數據庫連接
2. 數據庫類型正確（需要支持頁面創建）
3. 重新載入擴展後重試

**授權步驟：**
```
Notion 數據庫 → 右上角 ... 
→ Add connections 
→ 選擇你的 Integration
```

### 💾 保存問題

**Q3: 保存失敗，顯示錯誤？**

**A:** 常見原因：
- **網絡問題**：檢查網絡連接，重試
- **API 限制**：Notion API 有速率限制（3 請求/秒），稍後重試
- **內容過長**：v2.7.3+ 已修復，確保使用最新版本
- **權限問題**：確認 Integration 有寫入權限

**調試步驟：**
```
1. F12 打開控制台
2. 切換到 Console 標籤
3. 查看錯誤信息（以 ❌ 開頭）
4. 記錄錯誤並反饋
```

**Q4: 保存的內容不完整？**

**A:** 可能原因：
- **動態加載內容**：某些網站內容需要滾動才加載，保存前先滾動到底部
- **受保護內容**：付費牆或登錄保護的內容無法提取
- **特殊頁面結構**：某些 SPA 應用可能不完全兼容

**建議：**
- 等待頁面完全加載後再保存
- 使用 Readability 友好的網站
- 檢查 Notion 頁面確認實際內容

**Q5: "Open in Notion" 按鈕不顯示？**

**A:** 檢查：
1. 頁面是否已保存（圖標有綠色 ✓）
2. 是否是 v2.7.0+ 保存的頁面（舊頁面需重新保存）
3. 等待 2-3 秒（按鈕異步加載）
4. 關閉並重新打開彈出窗口

**解決方案：**
```
如果是舊頁面：
1. 打開該頁面
2. 點擊 "Save Page" 重新保存
3. 關閉並重新打開彈出窗口
4. 按鈕會出現
```

### 🎨 標註問題

**Q6: 標註無法創建？**

**A:** 確認：
1. 是否已點擊「Start Highlighting」
2. 是否選擇了標註顏色
3. 選中的文字是否在頁面主要內容中
4. 瀏覽器是否支持 CSS Highlight API（Chrome 105+）

**Q7: 標註不同步到 Notion？**

**A:** 檢查：
1. 是否點擊了「**同步**」按鈕
2. 頁面是否已保存（必須先保存頁面）
3. 網絡連接是否正常
4. 查看控制台是否有錯誤

**手動同步：**
```
1. 點擊擴展圖標
2. 點擊「同步」按鈕
3. 等待同步完成
4. 檢查 Notion 頁面
```

**Q8: 舊標註（黃色背景）還在？**

**A:** 這是遷移過程的正常現象：
- 新系統使用 CSS Highlight API（無 DOM 修改）
- 舊標註是 `<span>` 標籤（黃色背景）
- 刷新頁面後舊標註會被新系統接管
- 不影響功能，標註數據已保存

**清理步驟（可選）：**
```
1. 刷新頁面
2. 重新啟用標註模式
3. 舊樣式會自動清除
```

### 🗑️ 數據管理

**Q9: 如何刪除已保存的頁面？**

**A:** 在 Notion 中直接刪除即可：
1. 打開 Notion 數據庫
2. 找到對應頁面
3. 刪除頁面
4. 擴展會自動清除本地記錄（徽章會消失）

**Q10: 擴展存儲了哪些數據？**

**A:** 本地存儲的數據：
- `saved_{url}`: 頁面保存狀態和 Notion URL
- `highlights_{url}`: 標註數據（Range 位置信息）
- API Token 和設置（加密存儲）

**查看存儲數據：**
```
1. F12 打開控制台
2. 輸入: chrome.storage.local.get(null, console.log)
3. 查看所有本地數據
```

**Q11: 如何清理無效數據？**

**A:** v2.7.2+ 版本已自動清理：
- 刪除 Notion 頁面時自動清理本地數據
- 減少 90%+ 無效數據累積
- 無需手動操作

**數據管理功能（v2.8.1 改進）：**
```
1. 設置頁面 → 數據管理
2. 檢查數據完整性 - 檢測並統計遷移數據
3. 數據重整 - 清理遷移數據並釋放空間
4. 自動清理 - 刪除無效數據
```

**改進內容：**
- ✅ 修復檢查數據完整性功能
- ✅ 修復數據重整功能（真正執行刪除）
- ✅ 修復自動清理功能
- ✅ 添加遷移數據檢測邏輯

### ⚡ 效能問題

**Q12: 保存速度很慢？**

**A:** 正常範圍：
- 一般頁面：2-5 秒
- 超長文章（8000+ 字）：10-20 秒（自動分批）
- 大量標註：額外 2-3 秒

**優化建議：**
- 檢查網絡速度
- 減少不必要的標註
- 避免保存超大圖片

**Q13: 標註模式下頁面卡頓？**

**A:** 可能原因：
- 頁面本身複雜度高
- 標註數量過多（100+ 個）
- 瀏覽器效能限制

**解決方案：**
- 關閉標註模式（點擊「Stop Highlighting」）
- 清理不需要的標註
- 重啟瀏覽器

---

## 🔧 故障排除

### 🔍 調試步驟

**步驟 1：檢查擴展狀態**
```
1. 訪問 chrome://extensions/
2. 確認擴展已啟用
3. 檢查是否有錯誤提示
4. 嘗試重新載入擴展
```

**步驟 2：查看控制台日誌**
```
1. F12 打開開發者工具
2. 切換到 Console 標籤
3. 過濾日誌：
   - 🚀 = 初始化
   - 📦 = 存儲操作
   - 🎨 = 標註操作
   - 📤 = 批次上傳
   - ❌ = 錯誤
```

**步驟 3：檢查後台服務**
```
1. chrome://extensions/
2. 找到 "Notion Smart Clipper"
3. 點擊「檢查 service worker」
4. 查看後台腳本日誌
```

### 🩹 常見錯誤診斷

**錯誤：「Failed to fetch」**
- **原因**：網絡連接問題或 Notion API 不可達
- **解決**：檢查網絡，確認 Notion 服務正常

**錯誤：「Invalid API Token」**
- **原因**：API Token 錯誤或過期
- **解決**：重新生成 Token 並更新設置

**錯誤：「Database not found」**
- **原因**：數據庫未授權或已刪除
- **解決**：重新授權 Integration 訪問數據庫

**錯誤：「Rate limit exceeded」**
- **原因**：超過 Notion API 速率限制
- **解決**：等待 1-2 分鐘後重試

### 🔄 重置和恢復

**重置擴展設置：**
```
1. 設置頁面 → 高級選項
2. 點擊「重置所有設置」
3. 確認操作
4. 重新配置 API Token 和數據庫
```

**恢復標註數據：**
```
標註數據存儲在 Notion 頁面中，如果本地丟失：
1. 打開對應的 Notion 頁面
2. 查看標註區塊（帶顏色背景）
3. 標註會自動同步到瀏覽器
```

**完全重裝擴展：**
```
1. chrome://extensions/
2. 點擊「移除」
3. 重新載入擴展
4. 重新配置設置
```

---

## 📝 最佳實踐

### 🎯 推薦工作流

**學習型閱讀：**
```
1. 瀏覽文章，標註重點（多色分類）
2. 保存到 Notion
3. Open in Notion 打開
4. 添加個人筆記和思考
5. 創建反向連結
```

**快速收藏：**
```
1. 發現精彩內容
2. 直接點擊 Save Page
3. 稍後在 Notion 中批量整理
```

**深度研究：**
```
1. 詳細標註（使用不同顏色）
2. 保存到專門的研究數據庫
3. Open in Notion 立即編輯
4. 添加標籤、關聯頁面
5. 整理成知識圖譜
```

### 📚 內容組織建議

**使用模板區分內容類型：**
```
技術文章: [Tech] {title} - {date}
新聞資訊: 📰 {title} | {domain}
學習資源: 📖 {title}
靈感收藏: 💡 [{domain}] {title}
```

**在 Notion 中的組織方式：**
- 使用**標籤**分類（如 #技術、#設計、#思考）
- 使用**多視圖**（表格、看板、時間線）
- 創建**關聯數據庫**（如「閱讀清單」）
- 定期回顧和整理

### ⚡ 效率提升技巧

**1. 設置鍵盤快捷鍵**
```
chrome://extensions/shortcuts
→ 為「激活擴展」設置快捷鍵
→ 例如: Ctrl+Shift+S (Windows)
→ 例如: Cmd+Shift+S (Mac)
```

**2. 使用瀏覽器標籤分組**
```
1. 按主題分組標籤頁
2. 批量標註同主題內容
3. 統一保存到對應數據庫
```

**3. 建立定期回顧習慣**
```
每週: 回顧保存的頁面
每月: 整理和歸檔
每季: 清理不需要的內容
```

### 🎨 標註最佳實踐

**顏色使用建議：**
- 🟡 **黃色**：一般重點（最常用）
- 🟢 **綠色**：正面內容、成功案例、最佳實踐
- 🔵 **藍色**：概念定義、參考資料、補充信息
- 🔴 **紅色**：核心要點、問題、警告
- 🟣 **紫色**：個人思考、疑問、待辦事項

**標註原則：**
- ✅ 精選標註，不要過度標記
- ✅ 同類內容使用相同顏色
- ✅ 標註後立即同步
- ✅ 定期清理不需要的標註

---

## 🔗 相關資源

- 📚 [項目 README](README.md) - 項目概覽和快速開始
- 📝 [更新日誌](CHANGELOG.md) - 完整版本歷史
- 🔒 [隱私政策](PRIVACY.md) - 數據和隱私說明
- 🆕 [v2.7.0 新功能指南](USER_GUIDE_v2.7.0.md) - 最新版本特性

---

## 💬 反饋與支持

如果本指南沒有解決你的問題，或者有任何建議：

- 📧 提交 Issue（推薦）
- 💬 參與討論
- 🐛 報告 Bug

**提交 Issue 時請包含：**
- 擴展版本號
- 瀏覽器版本
- 問題描述和重現步驟
- 控制台錯誤日誌（如有）
- 截圖（如需要）

---

<div align="center">

**🎉 感謝使用 Notion Smart Clipper！**

如果覺得有幫助，歡迎 ⭐ Star 項目！

</div>
